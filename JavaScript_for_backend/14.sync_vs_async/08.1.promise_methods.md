# Advanced Promise Methods in JavaScript

## Why These Promise Methods Exist

In real applications, we often:

* Call **multiple APIs**
* Perform **parallel async operations**
* Want **faster execution**
* Need **control over success/failure behavior**

JavaScript provides **Promise combinator methods** to handle such cases cleanly.

---

## 1. `Promise.all()` – All Must Succeed

### What It Does

* Runs multiple promises **in parallel**
* Resolves **only if all promises succeed**
* Rejects immediately if **any one fails**

### Use Case

* Dashboard data
* Multiple APIs needed to render a page

---

### Example: Multiple FakeStore APIs

```javascript
const productsPromise = fetch("https://fakestoreapi.com/products");
const categoriesPromise = fetch("https://fakestoreapi.com/products/categories");

Promise.all([productsPromise, categoriesPromise])
  .then(function (responses) {
    return Promise.all([
      responses[0].json(),
      responses[1].json()
    ]);
  })
  .then(function ([products, categories]) {
    console.log("Products:", products);
    console.log("Categories:", categories);
  })
  .catch(function (error) {
    console.log("One API failed:", error);
  });
```

### Key Rule

* One failure = total failure

---

## 2. `Promise.allSettled()` – Wait for All (Success or Fail)

### What It Does

* Waits for **all promises to finish**
* Never rejects
* Returns **status of each promise**

### Use Case

* Reports
* Logs
* Background tasks
* Partial UI rendering

---

### Example

```javascript
const p1 = fetch("https://fakestoreapi.com/products");
const p2 = fetch("https://fakestoreapi.com/invalid-url");

Promise.allSettled([p1, p2])
  .then(function (results) {
    console.log(results);
  });
```

### Output Structure

```javascript
[
  { status: "fulfilled", value: Response },
  { status: "rejected", reason: Error }
]
```

### Key Rule

* You get **full visibility**
* No early termination

---

## 3. `Promise.race()` – First One Wins

### What It Does

* Resolves or rejects with **the first settled promise**
* Ignores the rest

### Use Case

* Timeouts
* Fastest API selection
* Fallback strategies

---

### Example: Fastest API Wins

```javascript
const fastAPI = fetch("https://fakestoreapi.com/products");
const slowAPI = new Promise(function (resolve) {
  setTimeout(() => resolve("Slow API"), 3000);
});

Promise.race([fastAPI, slowAPI])
  .then(function (result) {
    console.log("Winner:", result);
  })
  .catch(function (error) {
    console.log("Error:", error);
  });
```

### Key Rule

* First settled = result
* Can be success or failure

---

## 4. `Promise.any()` – First Successful Promise

### What It Does

* Resolves with the **first successful promise**
* Ignores failures
* Rejects **only if all promises fail**

### Use Case

* Backup APIs
* CDN fallback
* Redundant services

---

### Example: Backup API Strategy

```javascript
const api1 = fetch("https://fakestoreapi.com/invalid-url");
const api2 = fetch("https://fakestoreapi.com/products");

Promise.any([api1, api2])
  .then(function (response) {
    return response.json();
  })
  .then(function (data) {
    console.log("Data received:", data);
  })
  .catch(function (error) {
    console.log("All APIs failed:", error);
  });
```

### Key Rule

* Needs **at least one success**
* Rejects with `AggregateError` if all fail

---

## 5. `.finally()` – Always Executes

### What It Does

* Runs **after success or failure**
* Does not receive result or error
* Used for cleanup logic

### Use Case

* Hide loaders
* Stop spinners
* Logging

---

### Example

```javascript
fetch("https://fakestoreapi.com/products")
  .then(res => res.json())
  .then(data => console.log(data))
  .catch(err => console.log(err))
  .finally(() => {
    console.log("API call finished");
  });
```

---

## Comparison Table (Very Important)

| Method                 | Stops on Failure    | Needs All Success | Returns        |
| ---------------------- | ------------------- | ----------------- | -------------- |
| `Promise.all()`        | Yes                 | Yes               | Results array  |
| `Promise.allSettled()` | No                  | No                | Status objects |
| `Promise.race()`       | Yes (first)         | No                | First settled  |
| `Promise.any()`        | No (until all fail) | One success       | First success  |
| `.finally()`           | N/A                 | N/A               | No data        |

---

## When to Use What (Real Guidance)

* Use `Promise.all()`
  When **everything is mandatory**

* Use `Promise.allSettled()`
  When **partial success is acceptable**

* Use `Promise.race()`
  When **speed matters**

* Use `Promise.any()`
  When **reliability matters**

---

## Key Takeaways

* Promises are not just `.then()` and `.catch()`
* Promise combinators are **critical for real projects**
* Choosing the wrong method can break logic
* These methods are heavily asked in interviews

---
