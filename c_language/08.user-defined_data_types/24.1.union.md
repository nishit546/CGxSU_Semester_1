# 24: Unions in C

---

## 1) What is a Union?

* A **union** in C is like a **structure**, but with one big difference:

  * In a **structure**, **each member has its own storage**.
  * In a **union**, **all members share the same memory space**.

* This means:

  * A union’s size = size of its **largest member**.
  * At any time, only **one member holds a valid value** (others get overwritten).

---

## 2) Syntax of a Union

```c
union UnionName {
    data_type member1;
    data_type member2;
    ...
};
```

Example:

```c
union Data {
    int i;
    float f;
    char str[20];
};
```

---

## 3) Difference between `struct` and `union`

| Feature         | `struct`                                | `union`                               |
| --------------- | --------------------------------------- | ------------------------------------- |
| **Memory**      | Each member has separate memory         | All members share the same memory     |
| **Size**        | Sum of all members’ sizes               | Size of largest member                |
| **Usage**       | Store multiple different fields at once | Store only one field at a time        |
| **Example use** | Student record (name, roll, marks)      | Variant data (int OR float OR string) |

---

## 4) Memory-Sharing Behavior (Demo)

```c
#include <stdio.h>
#include <string.h>

union Data {
    int i;
    float f;
    char str[20];
};

int main() {
    union Data d;

    d.i = 10;                     // store int
    printf("d.i = %d\n", d.i);

    d.f = 22.5;                   // overwrites int
    printf("d.f = %.1f\n", d.f);
    printf("d.i (overwritten) = %d\n", d.i);

    strcpy(d.str, "CodingGita");  // overwrites float
    printf("d.str = %s\n", d.str);
    printf("d.f (overwritten) = %.1f\n", d.f);

    printf("Size of union = %zu\n", sizeof(d));
    return 0;
}
```

**Possible Output**

```
d.i = 10
d.f = 22.5
d.i (overwritten) = 1109917696
d.str = CodingGita
d.f (overwritten) = 26073.0
Size of union = 20
```

---

### Explanation

* When we wrote `d.i = 10`, memory held integer `10`.
* Then `d.f = 22.5` stored float into **same memory**, overwriting the int.
* Then `d.str = "CodingGita"` copied text into that memory, overwriting float.
* **Only the last written member is reliable.**

---

## 5) Practical Example: Variant Data Type

Imagine a **school database** where some IDs are numeric and some are string-based.
We can use a **union inside a struct** to store either.

```c
#include <stdio.h>
#include <string.h>

union ID {
    int roll_no;
    char reg_code[10];
};

struct Student {
    char name[20];
    union ID id;
    int is_numeric;   // flag: 1=int, 0=string
};

int main() {
    struct Student s1, s2;

    strcpy(s1.name, "Neel");
    s1.id.roll_no = 101;
    s1.is_numeric = 1;

    strcpy(s2.name, "Yashvi");
    strcpy(s2.id.reg_code, "CSE2025");
    s2.is_numeric = 0;

    // Display
    if (s1.is_numeric)
        printf("%s Roll=%d\n", s1.name, s1.id.roll_no);
    else
        printf("%s RegCode=%s\n", s1.name, s1.id.reg_code);

    if (s2.is_numeric)
        printf("%s Roll=%d\n", s2.name, s2.id.roll_no);
    else
        printf("%s RegCode=%s\n", s2.name, s2.id.reg_code);

    return 0;
}
```

**Output**

```
Neel Roll=101
Yashvi RegCode=CSE2025
```

---

## 6) Key Takeaways

* **Struct** → all members exist **together**.
* **Union** → all members **share the same memory**.
* Use **unions** when you want to store **different types of data but only one at a time**.
* Common in **embedded systems, compilers, variant datatypes, protocol parsers**.

---
